<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Support Ticket</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div th:replace="common/header :: header"></div>
    
    <div class="dashboard-container">
        <div th:replace="common/sidebar :: sidebar"></div>
        
        <div class="main-content">
            <h1>Create Support Ticket</h1>
            
            <div class="alert alert-danger" th:if="${error}" th:text="${error}"></div>
            <div class="alert alert-success" th:if="${success}" th:text="${success}"></div>
            
            <div class="form-container">
                <form th:action="@{/api/tickets}" th:object="${ticketCreateDTO}" method="POST" enctype="multipart/form-data">
                    <input type="hidden" th:field="*{companyId}" th:value="${companyId}">
                    <input type="hidden" th:field="*{customerId}" th:value="${customerId}">
                    <input type="hidden" th:field="*{source}" value="WEB">
                    
                    <div class="form-group">
                        <label for="title">Ticket Title *</label>
                        <input type="text" id="title" th:field="*{title}" required placeholder="Brief summary of your issue">
                        <span class="error" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></span>
                    </div>
                    
                    <div class="form-group">
                        <label for="categoryId">Category</label>
                        <select id="categoryId" th:field="*{categoryId}">
                            <option value="">-- Select Category --</option>
                            <option th:each="category : ${categories}" 
                                    th:value="${category.id}" 
                                    th:text="${category.name}">Category Name</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="priority">Priority</label>
                        <select id="priority" th:field="*{priority}">
                            <option value="LOW">Low</option>
                            <option value="MEDIUM" selected>Medium</option>
                            <option value="HIGH">High</option>
                            <option value="URGENT">Urgent</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description *</label>
                        <textarea id="description" th:field="*{description}" rows="6" required 
                                  placeholder="Please provide detailed information about your issue"></textarea>
                        <span class="error" th:if="${#fields.hasErrors('description')}" th:errors="*{description}"></span>
                    </div>
                    
                    <div class="form-group">
                        <label for="tags">Tags</label>
                        <input type="text" id="tags" th:field="*{tags}" placeholder="Comma-separated tags (e.g., login, password, error)">
                    </div>
                    
                    <div class="form-group">
                        <label for="attachments">Attachments</label>
                        <input type="file" id="attachments" name="files" multiple>
                        <p class="help-text">You can upload up to 5 files (max 5MB each). Accepted formats: jpg, png, pdf, doc, docx, txt</p>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn primary-btn">Submit Ticket</button>
                        <a href="/customer/tickets" class="btn secondary-btn">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div th:replace="common/footer :: footer"></div>
    <script src="/js/ticket-create.js"></script>
</body>
</html>